<?php
/**
 * @user: thanatos <thanatos915@163.com>
 */
namespace common\components\vendor;
use yii\base\Event;

/**
 * 扩展官方Response类，增加自定义处理
 * @package common\extension
 * @author thanatos <thanatos915@163.com>
 */
class Response extends \yii\web\Response
{
    public function init()
    {
        parent::init(); // TODO: Change the autogenerated stub
        $this->on(static::EVENT_BEFORE_SEND, [$this, 'formatMessage']);
    }

    /**
     * @param Event $event
     */
    public function formatMessage(Event $event)
    {
        /** @var static $response */
        $response = $event->sender;
        if ($response->data !== null && is_array($response->data)) {
            $response->data = [
                'success' => $response->isSuccessful,
                'data' => $response->data,
            ];
            $response->statusCode = 200;
        }
    }

}